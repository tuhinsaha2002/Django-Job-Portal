{% extends "base.html" %}

{% block content %}
<div class="container">
    <h1>Choose Your Subscription Plan</h1>
    <p>Proceed to payment for your chosen plan.</p>
    <button id="rzp-button1" class="btn btn-primary">Pay with Razorpay</button>
</div>

<script src="https://checkout.razorpay.com/v1/checkout.js"></script>
<script>
    var options = {
        "key": "{{ razorpay_key }}", // Enter the Key ID generated from the Razorpay Dashboard
        "amount": "{{ data.amount }}", // Amount in currency subunits (e.g., 50000 means 500.00 INR)
        "currency": "INR",
        "name": "JOB HUNT",
        "description": "Subscription Payment",
        "image": "https://example.com/your_logo", // Add your logo URL
        "order_id": "{{ payment.id }}", // Order ID received from the backend
        "handler": function (response) {
            window.location.href = `/payment-success?payment_id=${response.razorpay_payment_id}&order_id={{ data.receipt }}`;
        },
        "prefill": {
            "name": "{{ user.first_name }} {{ user.last_name }}",
            "email": "{{ user.email }}",
            "contact": "{{ user.profile.phone_number }}" // Adjust this based on your user model
        },
        "notes": {
            "address": "Corporate Office Address"
        },
        "theme": {
            "color": "#3399cc"
        }
    };
    var rzp1 = new Razorpay(options);
    rzp1.on('payment.failed', function (response) {
        alert("Payment Failed: " + response.error.description);
    });
    document.getElementById('rzp-button1').onclick = function (e) {
        rzp1.open();
        e.preventDefault();
    };
</script>
{% endblock content %}
